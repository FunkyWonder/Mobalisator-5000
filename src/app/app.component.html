<button mat-fab *ngIf="slidesArray.length === 0 || slidesArray === undefined" class="add-first-slide-button" (click)="onNewSlideClick()">+</button>
<swiper-container class="swiper" #swiperRef init="false">
  <!-- Generate slides -->
  <swiper-slide *ngFor="let slide of slidesArray as array">
    <!-- grid -->
    <gridster class="gridster" [options]="completeGridsterOptions">
      <!-- Generate tiles -->
      <gridster-item [item]="item" [id]="slide.hex" *ngFor="let item of slide.grid.layout">
        <!-- delete button -->
        <button class="delete-button" (click)="onRemoveTile(slide.hex, item['id'])"><ng-icon name="heroTrash"></ng-icon></button>
        <!-- Tile content -->
        <div *ngFor="let gridItem of slide.grid.items">
          <div *ngIf="gridItem['hex'] === item['id'] && gridItem.content.type === 'text'" contenteditable="true">
            <form>
              <mat-form-field>
                <mat-label>Your message</mat-label>
                <input type="text" matInput value="{{gridItem.content.text}}"
                      placeholder="{{ gridItem.content.text }}">
              </mat-form-field>
            </form>
          </div>
          <div *ngIf="gridItem['hex'] === item['id'] && gridItem.content.type === 'picture'">
            <img class="tile-item-picture" src="{{gridItem.content.path}}">
          </div>
          <div class="project-build-status-container" *ngIf="gridItem['hex'] === item['id'] && gridItem.content.type === 'project-build-status'">
            <div class="project-build-status-text-container">
              <span>{{ gridItem.content.title }}</span>
              <br>
              <span class="build-status-text" [style.color]="projectCoverageToHexColor(getProjectCoverage(gridItem.content.projectId))">
                <strong>{{ getProjectStatus(gridItem.content.projectId) }}</strong>
              </span>
            </div>
          </div>
          <div class="project-build-status-container" *ngIf="gridItem['hex'] === item['id'] && gridItem.content.type === 'queue-status'">
            <div class="project-build-status-text-container">
              <span>{{ gridItem.content.title }}</span>
              <br>
              <span class="build-status-text">
                <strong>{{ queueMinutes }}:{{ queueSeconds }} minutes</strong>
              </span>
            </div>
          </div>
        </div>
        
        <!-- if the tile has no content -->
        <div class="add-content-container" *ngIf="!item['hasItem']" >
          <mat-form-field class="add-content-selector">
            <mat-label>Tile item</mat-label>
            <mat-select [(value)]="item['selectedItem']">
              <mat-option *ngFor="let tileItem of tileItems" [value]="tileItem">
                {{tileItem["friendly_name"]}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <button mat-stroked-button class="add-content-button" (click)="onAddContent(slide.hex, item['id'], item['selectedItem'])"><ng-icon name="heroPlus"></ng-icon></button>
          </div>
      </gridster-item>
    </gridster>
  </swiper-slide>
</swiper-container>

<div #sidebar class="sidebar" [ngStyle]="{'right': sidebarVisible === true ? '0vw' : '-40vw'}">
  <button class="button" (click)="onNewSlideClick()" (keydown.space)="$event.preventDefault()">New Slide</button>
  <button class="button" (click)="onClearConfig()" (keydown.space)="$event.preventDefault()">Clear Config</button>
  <button class="button" (click)="onAddTile()" (keydown.space)="$event.preventDefault()">Add tile</button>
</div>

<style>
  .swiper {
    height: 100vh;
    width: 100vw;
  }

  .gridster, swiper-slide {
    height: 100%;
    background-color: #F1F1E6;
  }
 
  gridster-item {
    background-color: #F1F1E6;
    border: 2px solid #004082;
    box-sizing: border-box;
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    border-radius: 8px;
  }

  .button {
    width: 5rem;
    height: 5rem;
  }

  .delete-button {
    position: absolute;
    top: 0px;
    right: 0px;
    background-color: #5EA9FF;
    border-radius: 100%;
    aspect-ratio: 1/1;
    z-index: 100;
    opacity: 0;
    transition: opacity 100ms;
    border-color: transparent;
    border-style: solid;
    padding: 0.25rem;
    margin: 0.6rem;
  }
  .add-content-container {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);

    background-color: white;
    display: flex;
    flex-direction: column;
    min-width: 50%;
    max-width: 90%; 
    padding: 1rem;
    border-radius: 5px;
  }
  .add-content-button, .add-content-selector{
    color: black;
    background-color: white;
    float: left;
  }

  .tile-item-picture {
    width: 100%;
    height: 100%;
    object-fit: contain;
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
  }

  .project-build-status-container {
    display: flex;
    flex-direction: column;
    text-align: center;
  }

  .project-build-status-text-container {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: min(3vh,1.7vw);
  }
  .build-status-text {
    /* font-size: xx-large; */
    font-size: 2em;
  }
  gridster-item:hover .delete-button {
    opacity: 1;
  }

  .openSidebar {
    position: fixed;
    bottom: 1rem;
    right: 1rem;
    width: 5rem;
    height: 5rem;
    z-index: 500;
  }

  .sidebar {
    position: fixed;
    height: 100vh;
    top: 0%;
    /* right: -40vw; */
    width: 40vw;
    background-color: rgba(255, 255, 255, 100);
    z-index: 1000;
    transition: right 300ms;
  }

  #test-chart {
    position: relative;
    z-index: 2;
  }
  .add-first-slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: lightgray;
    z-index: 1000;
  }
  .add-first-slide-button {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1000;
    background-color: #D4A418;
    padding: 3rem;
    text-align: center;
    font-size: xx-large;
  }
</style>

<router-outlet></router-outlet>